# Создание платежа по токену карты

## OpenAPI Specification

```yaml
openapi: 3.0.1
info:
  title: ''
  description: ''
  version: 1.0.0
paths:
  /payment:
    post:
      summary: Создание платежа по токену карты
      deprecated: false
      description: >-
        В ответе возвращается {PaymentModel}. В случае, если в ответе поле
        otp_hash=null, то подтверждение платежа доступно без SMS-кода (для этого
        необходимо отправить [запрос на подтверждение
        платежа](#4db015c3-bf1a-4ea9-a570-dd8c2761c561) с пустым телом).
      tags:
        - Оплата на странице Партнера
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                card:
                  type: object
                  properties:
                    token:
                      type: string
                      description: |-
                        Max length:255
                        Токен карты для проведения платежных операций с картой
                  required:
                    - token
                  x-apidog-orders:
                    - token
                  x-apidog-ignore-properties: []
                amount:
                  type: integer
                  description: Сумма платежа в тийинах
                store_id:
                  type: integer
                  description: ID кассы Партнера в системе Multicard
                invoice_id:
                  type: string
                  description: >-
                    Max length:255

                    Любой идентификатор заказа в системе Партнера. Будет
                    возвращен в callback-запросе. Также по нему можно искать
                    платежи в кабинете мерчанта
                callback_url:
                  type: string
                  description: URL для отправки callback-запроса
                device_details:
                  type: object
                  properties:
                    ip:
                      type: string
                      description: >-
                        IP-адрес устройства клиента, с которого выполняется
                        запрос
                    user_agent:
                      type: string
                      description: >-
                        Cтрока User-Agent, содержащая информацию о браузере,
                        операционной системе и типе устройства клиента
                  required:
                    - ip
                    - user_agent
                  x-apidog-orders:
                    - ip
                    - user_agent
                  description: Объект с информацией об устройстве клиента
                  x-apidog-ignore-properties: []
                ofd:
                  description: Данные для формирования фискального чека
                  $ref: '#/components/schemas/ofdRequest'
              required:
                - card
                - amount
                - store_id
                - invoice_id
              x-apidog-orders:
                - card
                - amount
                - store_id
                - invoice_id
                - callback_url
                - device_details
                - ofd
              x-apidog-ignore-properties: []
            example:
              card:
                token: 6225f3c93f7a880142782fa4
              amount: 50000
              store_id: 6
              invoice_id: test
              callback_url: https://test.uz/callback
              device_details:
                ip: 177.14.322.11
                user_agent: >-
                  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0
                  Safari/537.36
              ofd:
                - qty: 1
                  price: 60000000
                  mxik: '06401004002000000'
                  total: 60000000
                  package_code: '1506113'
                  name: кроссовки men's low shoes
                - qty: 1
                  price: 55700000
                  mxik: '06401002004000000'
                  total: 55700000
                  package_code: '1519041'
                  name: кроссовки t.ace 2332 white black
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: object
                properties: {}
                x-apidog-orders: []
                x-apidog-ignore-properties: []
              example: |-
                {
                    "success": true,
                    "data": {PaymentModel}
                }
          headers: {}
          x-apidog-name: PaymentModel
        '400':
          description: >-
            При отправке запроса с допущением ошибки валидации, возвращается
            ошибка с кодом 400
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: Статус запроса
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        description: Кодовое сообщение
                      details:
                        type: string
                        description: Описание ошибки
                    required:
                      - code
                      - details
                    x-apidog-orders:
                      - code
                      - details
                    description: Ошибка
                    x-apidog-ignore-properties: []
                required:
                  - success
                  - error
                x-apidog-orders:
                  - success
                  - error
                x-apidog-ignore-properties: []
              example:
                success: false
                error:
                  code: ERROR_FIELDS
                  details: Необходимо заполнить «Amount».
          headers: {}
          x-apidog-name: Ошибочная валидация
        x-400:Создание платежа с неверным токеном карты:
          description: >-
            При попытке создании платежа с указанным неверным токеном карты,
            возвращается ошибка с кодом 400
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: Статус запроса
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        description: Кодовое сообщение
                      details:
                        type: string
                        description: Описание ошибки
                    required:
                      - code
                      - details
                    x-apidog-orders:
                      - code
                      - details
                    description: Ошибка
                    x-apidog-ignore-properties: []
                required:
                  - success
                  - error
                x-apidog-orders:
                  - success
                  - error
                x-apidog-ignore-properties: []
              example:
                success: false
                error:
                  code: ERROR_CARD_NOT_FOUND
                  details: Неверный номер карты или срок действия
          headers: {}
          x-apidog-name: Создание платежа с неверным токеном карты
      security: []
      x-apidog-folder: Оплата на странице Партнера
      x-apidog-status: released
      x-run-in-apidog: https://app.apidog.com/web/project/1022226/apis/api-19729310-run
components:
  schemas:
    ofdRequest:
      type: array
      items:
        type: object
        properties:
          qty:
            type: integer
            description: Количество единиц товара/услуги
          vat:
            type: integer
            description: НДС (%)
          price:
            type: integer
            description: Стоимость единицы товара в тийинах
          mxik:
            type: string
            description: ИКПУ из справочника tasnif.soliq.uz
          total:
            type: integer
            description: Общая сумма товаров с учетом количества без учета скидок в тийинах
          package_code:
            type: string
            description: Код упаковки из справочника tasnif.soliq.uz
          name:
            type: string
            description: Наименование товара/услуги
          tin:
            type: string
            description: ИНН компании
        x-apidog-orders:
          - qty
          - vat
          - price
          - mxik
          - total
          - package_code
          - name
          - tin
        required:
          - qty
          - price
          - mxik
          - package_code
          - name
        x-apidog-ignore-properties: []
      x-apidog-folder: ''
  securitySchemes:
    bearer:
      type: http
      scheme: bearer
servers: []
security:
  - bearer: []

```
